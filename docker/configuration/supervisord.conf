[supervisord]
nodaemon=true                 ; Run in the foreground
logfile=/dev/stdout           ; Log to stdout
logfile_maxbytes=0            ; Disable log rotation
pidfile=/var/run/supervisord.pid ; Default pid file location

[program:caddy]
command=caddy run --config /etc/caddy/Caddyfile --adapter caddyfile
user=caddy
priority=10                   ; Start Caddy first (optional)
autostart=true
autorestart=true
stdout_logfile=/dev/stdout    ; Log stdout to supervisor's stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr    ; Log stderr to supervisor's stderr
stderr_logfile_maxbytes=0

[program:python_app]
# Correct command based on your original Dockerfile's ENTRYPOINT/CMD
# Assuming index.py is the entrypoint script and it accepts --conf and --port
command=/home/pending/venv/bin/python index.py --conf=config_web --port=9001
directory=/home/pending/pending.api ; Set working directory
user=pending
priority=20                   ; Start after Caddy (optional)
autostart=true
autorestart=true
stdout_logfile=/dev/stdout    ; Log stdout to supervisor's stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr    ; Log stderr to supervisor's stderr
stderr_logfile_maxbytes=0
stopsignal=INT                ; Send SIGINT to stop the Python app (matches STOPSIGNAL)
